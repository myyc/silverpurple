---
# yaml-language-server: $schema=https://schema.blue-build.org/module-list-v1.json
modules:
  # OS branding
  - type: os-release
    PRETTY_NAME: Silverpurple
    NAME: Silverpurple

  # Signing policy (baked into image for automatic verification)
  - type: signing

  # First: Install RPM Fusion repos and Mullvad repo
  - type: rpm-ostree
    repos:
      - https://repository.mullvad.net/rpm/stable/mullvad.repo
    install:
      - https://mirrors.rpmfusion.org/free/fedora/rpmfusion-free-release-43.noarch.rpm
      - https://mirrors.rpmfusion.org/nonfree/fedora/rpmfusion-nonfree-release-43.noarch.rpm

  # Second: Install packages (RPM Fusion repos are now available)
  - type: rpm-ostree
    remove:
      - firefox
      - firefox-langpacks
      - ffmpeg-free
      - libavcodec-free
      - libavdevice-free
      - libavfilter-free
      - libavformat-free
      - libavutil-free
      - libpostproc-free
      - libswresample-free
      - libswscale-free
      - mesa-va-drivers
    install:
      # Codecs and drivers (from RPM Fusion)
      - ffmpeg
      - ffmpegthumbnailer
      - mesa-va-drivers-freeworld
      - mesa-vdpau-drivers-freeworld
      - pipewire-codec-aptx
      # Fonts
      - google-noto-fonts-all-vf
      # Terminal tools
      - alacritty
      - fish
      - tmux
      - bat
      - lsd
      # Dev tools
      - java-latest-openjdk
      - nmap
      - tcpdump
      # Services
      - mullvad-vpn
      - nebula
      - syncthing
      - waydroid

  # Flatpak config - remove Fedora remote and all system flatpaks
  - type: default-flatpaks@v1
    system:
      repo-url: ""
      repo-name: ""
      repo-title: ""
      install: []
      remove:
        - fedora
        # Remove all default Silverblue flatpaks (from pungi-fedora config)
        - org.gnome.baobab
        - org.gnome.Calculator
        - org.gnome.Calendar
        - org.gnome.Characters
        - org.gnome.Snapshot
        - org.gnome.clocks
        - org.gnome.Connections
        - org.gnome.Contacts
        - org.gnome.Extensions
        - org.gnome.font-viewer
        - org.gnome.TextEditor
        - org.gnome.Loupe
        - org.gnome.Logs
        - org.gnome.Maps
        - org.fedoraproject.MediaWriter
        - org.gnome.NautilusPreviewer
        - org.gnome.Papers
        - org.gnome.Weather
    user:
      repo-url: https://dl.flathub.org/repo/flathub.flatpakrepo
      repo-name: flathub
      repo-title: Flathub
      install:
        - org.mozilla.firefox
        - org.gnome.Calculator
        - org.gnome.Calendar
        - org.gnome.Contacts
        - org.gnome.Loupe
        - org.gnome.NautilusPreviewer
        - org.gnome.Papers
        - org.gnome.Weather
        - org.gnome.font-viewer
        - com.belmoussaoui.Authenticator
        - com.mattjakeman.ExtensionManager
        - org.gtk.Gtk3theme.adw-gtk3
        - org.gtk.Gtk3theme.adw-gtk3-dark
